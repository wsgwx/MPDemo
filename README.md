# MPDemo 应用说明文档

## 概述

MPDemo是一个Android多媒体演示应用程序，支持双路独立播放器，可以分别播放音频和视频文件。该应用特别设计用于测试和演示多媒体播放功能，包括输出设备选择、循环播放、播放控制等功能。

## 功能特性

### 1. 双路独立播放器
- **Player 1** 和 **Player 2** 两个独立的播放器
- 每个播放器都有独立的控制按钮、进度条和音量控制
- 支持音频和视频文件播放

### 2. 文件选择功能
- 支持从系统文件管理器中选择媒体文件
- 自动检测文件类型（音频/视频）
- 支持多种格式的媒体文件

### 3. 输出设备控制
- 可以为每个播放器独立选择音频输出设备
- 支持蓝牙设备、USB音频设备等多种输出设备
- 在Android M及以上版本支持setPreferredDevice API

### 4. 播放控制
- 播放/暂停功能
- 进度条拖动控制
- 音量调节
- 循环播放开关

### 5. 状态管理
- 保存和恢复播放状态
- 防止播放器之间相互干扰
- 自动恢复播放位置

## 使用方法

### 1. 基本播放
1. 点击"Select Media for Player 1"或"Select Media for Player 2"按钮
2. 从文件管理器中选择音频或视频文件
3. 文件将在对应的播放器中开始播放

### 2. 设备选择
1. 点击"Select Device for Player 1"或"Select Device for Player 2"按钮
2. 从设备列表中选择输出设备
3. 播放器将输出到选定的设备

### 3. 播放控制
- 点击播放/暂停按钮控制播放状态
- 拖动进度条跳转到指定位置
- 使用音量按钮调节音量大小
- 切换循环播放开关控制是否循环播放

## 技术架构

### 1. 核心组件
- MediaPlayer：用于音频播放
- VideoView：用于视频播放
- MediaController：提供播放控制界面

### 2. 状态管理
- 独立的播放状态变量
- 播放位置记忆功能
- 循环播放状态控制

### 3. 设备管理
- AudioManager用于设备枚举
- AudioDeviceInfo用于设备信息获取
- setPreferredDevice用于设置输出设备

## 重要注意事项

1. **权限要求**：应用需要存储权限以访问媒体文件
2. **兼容性**：输出设备选择功能需要Android M（API 23）及以上版本
3. **资源管理**：播放器切换时会自动释放旧资源，避免内存泄漏
4. **状态隔离**：每个播放器有独立的状态控制，互不影响

## 故障排除

### 1. 播放器相互干扰
- 确保遵循了资源切换与释放规范
- 检查播放器状态是否正确保存和恢复

### 2. 设备选择无效
- 确认目标设备支持音频输出
- 检查Android版本是否支持setPreferredDevice API

### 3. 循环播放不工作
- 确认循环播放标志正确设置
- 检查OnCompletionListener是否正确实现

## 开发规范

本应用遵循以下开发规范：
- 多媒体播放器状态隔离、控制与恢复规范
- 多媒体播放器资源切换与释放规范
- 多媒体应用调试日志添加规范
- Android 15文件选择与存储权限适配规范